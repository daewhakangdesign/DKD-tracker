{% extends "layout.html" %}
{% block body %}
    <!--<h2>Wonderful People</h2>-->
    {% for person in people %}
        <!--<div>{{ person.name }} has climbed {{ person.event_count }}</div>-->

	<h2 class="hidden"><img id="{{loop.index}}" alt="missing profile pic!" width="120" height="120" src= {{ url_for('static', filename = ["css/images/", person.name,".jpg"]|join('')) }}> </h2>


	<div style="position:absolute; width: 200px; height: 200px; left: 20px;">
	  <div style="position:relative; top: 20px;">
	        <form action="/new-event" method="post">
	            <input hidden=true type="text" name="event_type" value="stairs">	
	            <input hidden=true type="text" name="person_uuid"  value="{{ person.uuid }}">
	            <input type="image" alt "Submit" width="123" height="123" src={{ url_for('static', filename = ["css/images/", person.name,".jpg"]|join('')) }} value={{ person.name }}>
        	    <!--input type="submit" value={{ person.name }}-->	
		    <!--button type="button">Click me!</button-->
	        </form>
	  </div>
	</div>

	<script>

   	  //import the person name of this iteration
	  var persId = "{{person.name}}";
	  var persEventCt = "{{person.event_count}}"
	  var loopIteration = "{{loop.index}}"
	 	
	  //import the image address

	  //creates the canvas
	  var canv = document.createElement("canvas");
	  canv.setAttribute('width', 1024);
	  canv.setAttribute('height', 180);
	  canv.setAttribute('id', persId);
	  //canv.style.border   = "1px solid";

	  document.body.appendChild(canv);

	  var canvas = document.getElementById(persId);
	  var ctx = canvas.getContext("2d");

	  ////////////////////////////////////////////////
	  //
	  //this element below is critical but not working. 
	  //when refreshing the browser on localhost we can get the	  
	  //pictures showing up, but when on google cloud we are struggling.
	  //

	  //place image (work in progress)	
	  //window.onload = function() {
	  //var img = document.getElementById(loopIteration);
	  //ctx.drawImage(img, 10, 9, 123, 123);
	  //}

	  //variable current date
	  var currentDay = 520

	  //variable holding the total count for the month	  
	  var lastMonthTotal = 0
	  var thisMonthTotal = 0

	  //draw last month
	  for (i = 0; i <= 720; i++) {
	  ctx.fillStyle = 'rgb(200,200,200)';
	  //randomly add stairs climbed if it happened	 
	  if (Math.random() < .1) {	
	  lastMonthTotal++;	
	  }

	  //the height of the rectangle is determined by thisMonthTotal
	  ctx.fillRect(i,170,1, - lastMonthTotal);
	  }

	  for (i = 0; i <= currentDay; i = i + 2) {
	  //randomly add stairs climbed if it happened
	  if (Math.random() < .2) {
	  //randomly add stairs climbed if it happened
	  thisMonthTotal++;
	  ctx.fillStyle = 'rgb(200,0,50)';	 
	  ctx.fillRect(i,170,1, - thisMonthTotal);
	  } else {
	  ctx.fillStyle = 'rgb(200,100,150)';
	  ctx.fillRect(i,170,1, - thisMonthTotal);
	  }
	  }

	  ctx.font = "84px Arial";
	  ctx.textAlign="right";
	  //ctx.fillText(leftPad(thisMonthTotal,3), 790,170);
	  ctx.fillText(persEventCt, 850,155);
	  ctx.font = "10px Arial";
	  ctx.textAlign="right";
	  ctx.fillText("FLIGHTS CLIMBED", 850,170);


	  //function for padding the stairs climbed
	  function leftPad(number, targetLength) {
 	   var output = number + '';	
	    while (output.length < targetLength) {	
	        output = '0' + output;
	    }	
	    return output;
}


	  </script>



    {% endfor %}
{% endblock %}